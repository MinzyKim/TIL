# Hadoop4일차

### 1. 분산 컴퓨팅

client가 요청 -> 프로그램 시작 -> 어플리케이션이 n개의 host에 나눠서 접속

- 물리적으로 하나 이상의 호스트에 연결, 처리, 제어

#### 1-1 필요조건

- 장애허용 
  - 한 host에 문제가 발생했을 때, 나머지 host에서 나눠서 처리해야 함
  - 분산 클러스터 노드 중 하나가 문제가 생겨도 메인 컴퓨팅 프로세스에 부정적인 영향을 주지 않아야 한다. (프로세스 실패가 발생하지 않아야 한다.)
- 복구능력 
  - 분산 클러스터 노드에서 수행중인 작업이 실패하더라도 작업으로부터 어떤 데이터도 손실되어선 안된다.

- 선형적 확장성
  - 추가된 호스트의 cpu, memory에 맞게 성능이 선형적으로 증가해야 한다.
  - 컴퓨팅 능력, 스토리지 공간 확장 등 성능도 선형적으로 증가해야 한다.



### 2. 하둡 아키텍쳐와 하둡 클러스터

#### 2.1 하둡 아키텍처

- HDFS, Yarn, MapReduce, API
- 하둡 클러스터를 기반으로 구성

#### 2.2 하둡 클러스터

- 하둡 분산파일시스템(HDFS)과 클러스터 리소스 매니저(Yarn)를 기반으로 하는 하둡 소프트웨어를 사용하는 컴퓨터들의 집합

- 장애 허용과 복구 능력을 위해 sharding, replication을 수행한다.

- 배치 처리, 파일 기반 처리(map의 처리 결과도 map처리된 datanode에 파일로 저장, reducer의 출력결과도 HDFS에 저장, disk기반, stream기반, sequenctial하게 처리)

  

### 3. 하둡의 노드

- Hadoop2.0부터 마스터 노드 2개 이상 구성 가능 고가용성(HA)

  [^HA]: High Availability

  을 지원한다.

- 마스터 노드(Active, Standby) 

  - 하둡 클러스터의 작업을 중재
  - 하둡 클라이언트는 파일을 저장, 읽고, 처리하려면 master노드에 접속
  - namenode가 구성되고, 파일을 저장, 쓰기 요청에 대해서 파일시스템의 메타정보 관리
  - mapreduce 작업의 중재하는 프로세스 JobTracker가 구성

- 워커 노드(슬레이드 노드)

  - 마스터 노드의 지시를 받아서 명령을 수행 (실제 데이터를 저장하고, 데이터 처리 프로세싱하는 노드, TaskTracker)

- HDFS는 HDFS의 스토리지를 관리
  - NameNode 
    -  HDFS 파일 시스템 디렉토리 트리와 파일의 위치등 HDFS 스토리지 관련 메타 정보(블럭 데이터를 데이터노드에 매핑)를 관리
    - 파일, 디렉토리, 생성, 열기, 쓰기 오퍼레이션 수행
    - 어떤 데이터 노드에 복제되고, 복제 후에 삭제할지 결정
    - 데이터 노드에서 보내온 하트비트와 블럭 리포트를 처리 (블럭 위치 유지, 데이터 노드의 상태 관리)
  - SecondaryName 
    - HDFS 스토리지 메타 정보 업데이트(기본 1시간 간격, fsimage파일과 editlog파일을 병합)
  - DataNode
    - 마스터 노드에 접속 유지, 3초 간격으로 heart beat를 보낸다.
    - block report를 주기적으로 전송
    - 마스터 노드의 요청을 처리(block저장, block 삭제)
    - 로컬 파일 시스템에 블록을 저장
    - 데이터에 대한 읽기, 쓰기 수행
    - 데이터 블록 생성 및 삭제 수행
    - 클러스터에 데이터 블럭 복제
    - 주기적으로 heartbeat와 블럭 리포트 전송
- Yarn 서비스
  - resource manager - 마스터 노드에서 실행, 클러스터의 리소스를 나눠주는 역할, Task들에 대한 스케줄링
  - node manager - 워크 노드에서 실행, Task들을 실행시키고 관리, resouurce manager와 관계 유지, Task의 상태, 노드 상태 관리
  - application manager - 클러스터상에서의 메인이 되는 마스터 프로세스로서 어플리케이션별로 하나씩 실행됨, 클러스터에서 실행되는 어플리케이션의 실행 조율, 리소스 매니저와 통신(관계 유지) 하면서 리소스 조절



