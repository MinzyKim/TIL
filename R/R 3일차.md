#  R 3일차

## 1. 복습

### 1. 벡터 요소 접근 방법

- `벡터객체[첨자]`
- `벡터객체[논리값]`
- 접근 요소 제외 : `벡터객체[-객체]`

### 2. 벡터 객체 집합 연산 내장 함수

- `intersect`
- `union`
- `setdiff`
- `identical`
- `setequal`

### 3. Matrix

- 벡터를 여러개 합친 것으로 2차원 구조의 데이터 저장소
- `rbind(row)`
- `cbind(column)` 
  - name을 정할때 `dimnames = , bynum= T`

- 타입이 다를 땐 요소의 개수가 동일해야 생성 됨
- 만약, 3열의 요소에만 접근하고 싶을 땐?
  - `matrix[ , 3] (행, 열)`

### 4. 행렬 객체 집합 연산 내장 함수

- 행렬곱 - `m객체 %*% n객체`
- 역행렬 - `solve(m 객체)`
- 전치 행렬 - `t(m 객체)`

### 5. Colnames(), Rownames()

- 이름을 바꿀 수 있는 함수

### 6. Array

- 다차원 데이터 저장소

- 인수 지정 
  - `array`(`데이터`, `디멘젼=(r,c,l)`)

### 7. List

- `key`, `value`로 구성

- `str()`
- `class()` - 형태 확인 하는 함수

- 데이터 접근
  - `list객체$key`

- 새로운 요소 추가
  - `list객체$New.key <- value`

- 요소 삭제
  - `list객체$New.key <- null`

- list를 벡터로 출력
  - `unlist()`

### 8. Dataframe

- RDBMS의 Table구조, Excel의 sheet 형태로 생긴 데이터 저장 구조

- subset
  - 조건식이 true인 데이터 프레임 요소 생성

- 두개의 Dataframe을 합칠 때
  - `merge`	 

- all = T

### 9. scan, readWrite

- 지금 하고 있는 데이터 파일 읽어올 때

### 10. read.csv 

- csv파일 읽어오기



## 2. 오늘자 진도

### 1. 헤더를 제외한 레코드 2개 skip(제외)하고, 2개의 record만 읽어오기

```R
fruits  <- read.table("./datas/fruits.txt", header=T, skip=2, nrows=2)
print(fruits )
str(fruits)
class(fruits)
```



### 2. R객체를 바이너리 파일로 저장 save(), load()

```R
str(fruits2)
save(fruits2, file="./output/fruits.RData")
```



### 3. XML 문서 읽어오기

```R
install.packages("XML")
library(XML)
data2 <- xmlParse(file="./data/emp.xml")
print(data2)
str(data2)

#ROOT NODE만 추출
rootnode <- xmlRoot(data2)
print(rootnode)
class(rootnode)
str(rootnode)

#rootnode의 자식 노드 갯수 
rootsize <- xmlSize(rootnode)
print(rootsize)

#rootnode의 첫번째 자식 노드 출력
print(rootnode[1])

#rootnode의 첫번째 자식 노드의 이름과 부서와 급여 출력
print(rootnode[[1]][[2]]);
print(rootnode[[1]][[3]]);
print(rootnode[[1]][[5]]);

#XML을 R의 지원형식인 data.frame으로 로딩
xmldataframe <- xmlToDataFrame("./datas/emp.xml")
print(xmldataframe)
str(xmldataframe)
```



### 4. JSON 파일 읽어오기 

```R
install.packages('rjson')
library(rjson)
rm(list=ls())
data1 <- fromJSON(file="./datas/emp.json") # json 파일로 저장하기
print(data1)
str(data1)


emp.dataframe<-as.data.frame(data1) # dataframe으로 만들기
print(emp.dataframe)
str(emp.dataframe)

fruits1 <- read.table("./datas/fruits.txt", header=T, stringsAsFactors = 2)
print(fruits1)
```



## 3. Error 해결하기

### 1. readTableHeader에 의하여 발견된 완성되지 않은 마지막 라인입니다

```R
> fruits  <- read.table("./datas/fruits.txt", header=T, skip=2, nrows=2)
Warning message:
In read.table("./datas/fruits.txt", header = T, skip = 2, nrows = 2) :
  './datas/fruits.txt'에서 readTableHeader에 의하여 발견된 완성되지 않은 마지막 라인입니다
```

- 읽어올 데이터파일의 마지막라인이 없을 경우 발생

  ![1567989782455](assets/1567989782455.png)

- 현재 5줄까지 작성되어 있고 6줄은 없는 상태

  ![1567989824882](assets/1567989824882.png)

- 6번째 줄 생성하고, 파일 다시 읽어오면 에러 해결



### 2. Package install Error

```R
Error in install.packages : ERROR: failed to lock directory ‘C:\Program Files\R\R-3.6.1\library’ for modifying
Try removing ‘C:\Program Files\R\R-3.6.1\library/00LOCK’
```

- 설치시 lock이 걸려 있던 것으로 추정
- lock00 풀어주기
  - 단순히 폴더명을 제거하면 Rstudio 아예 안돌아간다

```R
unlink("C:/Program Files/R/R-3.6.1/library/00LOCK", recursive = TRUE)

install.packages("XML")
library(XML)
```

- 잘 돌아간다.